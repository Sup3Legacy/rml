let process p {inout s} =
  loop
    pause;
    await one s (x) in
    print_int x;
  end

let process main {} =
  signal s in
  pause;
  pause;
  emit s 1;
  emit s 2
  || 
  run p {s=s}
  ||
  pause;
  pause;
  emit s 3  
