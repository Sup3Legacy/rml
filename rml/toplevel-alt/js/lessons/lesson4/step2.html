<p>
The two states are implemented with two mutually recurssive processes,
transitions are triggered by the emission of
signals <code>switch_on</code> and <code>switch_off</code> with
the <code>do/until</code> construct.
</p>

<p><pre class="code">
let light on off = 
 
  let rec process light_on = 
    do 
      print_endline "Light on!";
      halt
    until switch_off -> run state_off
    done

  and process light_off = 
    do 
      print_endline "Light off!";
      halt
    until switch_on -> run state_on
    done

in state_off;; 
</pre></p>
